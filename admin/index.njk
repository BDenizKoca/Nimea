---
permalink: /admin/index.html
---
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Content Manager | Nimea Wiki</title>
  <link href="{{ '/admin/config.yml' | url }}" type="text/yaml" rel="cms-config-url">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      margin: 0;
      padding: 0;
    }
    #cms-error {
      display: none;
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
      padding: 15px;
      margin: 20px;
      border-radius: 5px;
    }
    .auth-message {
      max-width: 600px;
      margin: 2rem auto;
      padding: 2rem;
      text-align: center;
      background: #f8f9fa;
      border-radius: 8px;
      border: 1px solid #dee2e6;
    }
    .auth-button {
      display: inline-block;
      padding: 12px 24px;
      background: #0366d6;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      margin: 10px;
      border: none;
      font-size: 16px;
      cursor: pointer;
    }
    .auth-button:hover {
      background: #0256cc;
    }
  </style>
</head>
<body>
  <div id="auth-message" class="auth-message" style="display:none;">
    <h2>GitHub Authentication Required</h2>
    <p>To access the Nimea Wiki CMS, you need to authenticate with GitHub.</p>
    <p>Click the button below to start the authentication process:</p>
    <button onclick="authenticateWithGitHub()" class="auth-button">
      Authenticate with GitHub
    </button>
    <p><small>You'll be redirected to GitHub to authorize access to the repository.</small></p>
  </div>
  
  <div id="cms-error" style="display:none;">
    <h3>Authentication Error</h3>
    <p>There was a problem with the authentication process.</p>
    <button onclick="retryAuth()" class="auth-button">Retry Authentication</button>
  </div>
  
  <!-- Include the script that builds the page and powers Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  
  <script>
    console.log('CMS admin page loaded');
    
    // GitHub OAuth configuration
    const GITHUB_CLIENT_ID = 'Ov23liPIUNxU8CSVPFIC';
    const GITHUB_REDIRECT_URI = 'https://bdenizkoca.github.io/nimea/callback.html';
    const GITHUB_SCOPE = 'repo';
    
    function authenticateWithGitHub() {
      const authURL = `https://github.com/login/oauth/authorize?` +
        `client_id=${GITHUB_CLIENT_ID}&` +
        `redirect_uri=${encodeURIComponent(GITHUB_REDIRECT_URI)}&` +
        `scope=${GITHUB_SCOPE}&` +
        `state=${Date.now()}`;
      
      console.log('Redirecting to GitHub auth:', authURL);
      window.location.href = authURL;
    }
    
    // Check if we have authentication data from callback
    function checkAuthStatus() {
      const authData = localStorage.getItem('decap-cms.auth');
      if (authData) {
        try {
          const auth = JSON.parse(authData);
          if (auth.token && auth.token.code) {
            console.log('Found auth data, initializing CMS');
            // Auth data exists, let CMS initialize normally
            return true;
          }
        } catch (e) {
          console.error('Error parsing auth data:', e);
          localStorage.removeItem('decap-cms.auth');
        }
      }
      return false;
    }
    
    // Initialize CMS or show auth prompt
    window.addEventListener('DOMContentLoaded', function() {
      setTimeout(() => {
        if (!checkAuthStatus()) {
          // No auth, show manual auth button
          document.getElementById('auth-message').style.display = 'block';
        } else {
          // We have auth, check if CMS loaded properly
          if (!window.CMS) {
            document.getElementById('cms-error').style.display = 'block';
          }
        }
      }, 2000);
    });
    
    function retryAuth() {
      // Clear any auth tokens from localStorage
      localStorage.clear();
      window.location.reload();
    }
  </script>
</body>
</html>
